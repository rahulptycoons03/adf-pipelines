{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "factoryName": {
      "type": "string",
      "metadata": {
        "description": "Name of the Data Factory"
      }
    }
  },
  "resources": [
    {
      "type": "Microsoft.DataFactory/factories/datasets",
      "apiVersion": "2018-06-01",
      "name": "[concat(parameters('factoryName'), '/AzureDataLakeStorageGen2')]",
      "properties": {
        "linkedServiceName": {
          "referenceName": "AzureDataLakeStorageGen2",
          "type": "LinkedServiceReference"
        },
        "parameters": {
          "folderPath": {
            "type": "String"
          },
          "fileName": {
            "type": "String"
          },
          "container": {
            "type": "String",
            "defaultValue": "bronze"
          }
        },
        "annotations": [],
        "type": "AzureBlobFSFile",
        "typeProperties": {
          "folderPath": {
            "value": "@dataset().folderPath",
            "type": "Expression"
          },
          "fileName": {
            "value": "@dataset().fileName",
            "type": "Expression"
          },
          "fileSystem": {
            "value": "@dataset().container",
            "type": "Expression"
          },
          "format": {
            "type": "DelimitedTextFormat",
            "columnDelimiter": ",",
            "rowDelimiter": "\n",
            "firstRowAsHeader": true,
            "nullValue": "",
            "treatEmptyAsNull": true
          }
        }
      }
    },
    {
      "type": "Microsoft.DataFactory/factories/datasets",
      "apiVersion": "2018-06-01",
      "name": "[concat(parameters('factoryName'), '/AzureDataLakeStorageGen2_Parquet')]",
      "properties": {
        "linkedServiceName": {
          "referenceName": "AzureDataLakeStorageGen2",
          "type": "LinkedServiceReference"
        },
        "parameters": {
          "folderPath": {
            "type": "String"
          },
          "fileName": {
            "type": "String"
          },
          "container": {
            "type": "String",
            "defaultValue": "silver"
          }
        },
        "annotations": [],
        "type": "Parquet",
        "typeProperties": {
          "location": {
            "type": "AzureBlobFSLocation",
            "folderPath": {
              "value": "@dataset().folderPath",
              "type": "Expression"
            },
            "fileName": {
              "value": "@dataset().fileName",
              "type": "Expression"
            },
            "fileSystem": {
              "value": "@dataset().container",
              "type": "Expression"
            }
          },
          "compressionCodec": "snappy"
        },
        "schema": []
      }
    },
    {
      "type": "Microsoft.DataFactory/factories/datasets",
      "apiVersion": "2018-06-01",
      "name": "[concat(parameters('factoryName'), '/BronzeContainer')]",
      "properties": {
        "linkedServiceName": {
          "referenceName": "AzureDataLakeStorageGen2",
          "type": "LinkedServiceReference"
        },
        "parameters": {
          "folderPath": {
            "type": "String"
          },
          "fileName": {
            "type": "String"
          }
        },
        "annotations": [],
        "type": "AzureBlobFSFile",
        "typeProperties": {
          "folderPath": {
            "value": "@dataset().folderPath",
            "type": "Expression"
          },
          "fileName": {
            "value": "@dataset().fileName",
            "type": "Expression"
          },
          "fileSystem": "bronze",
          "format": {
            "type": "DelimitedTextFormat",
            "columnDelimiter": ",",
            "rowDelimiter": "\n",
            "firstRowAsHeader": true
          }
        }
      }
    },
    {
      "type": "Microsoft.DataFactory/factories/datasets",
      "apiVersion": "2018-06-01",
      "name": "[concat(parameters('factoryName'), '/SilverContainer')]",
      "properties": {
        "linkedServiceName": {
          "referenceName": "AzureDataLakeStorageGen2",
          "type": "LinkedServiceReference"
        },
        "parameters": {
          "folderPath": {
            "type": "String"
          },
          "fileName": {
            "type": "String"
          }
        },
        "annotations": [],
        "type": "Parquet",
        "typeProperties": {
          "location": {
            "type": "AzureBlobFSLocation",
            "folderPath": {
              "value": "@dataset().folderPath",
              "type": "Expression"
            },
            "fileName": {
              "value": "@dataset().fileName",
              "type": "Expression"
            },
            "fileSystem": "silver"
          },
          "compressionCodec": "snappy"
        },
        "schema": []
      }
    },
    {
      "type": "Microsoft.DataFactory/factories/datasets",
      "apiVersion": "2018-06-01",
      "name": "[concat(parameters('factoryName'), '/GoldContainer')]",
      "properties": {
        "linkedServiceName": {
          "referenceName": "AzureDataLakeStorageGen2",
          "type": "LinkedServiceReference"
        },
        "parameters": {
          "folderPath": {
            "type": "String"
          },
          "fileName": {
            "type": "String"
          }
        },
        "annotations": [],
        "type": "Parquet",
        "typeProperties": {
          "location": {
            "type": "AzureBlobFSLocation",
            "folderPath": {
              "value": "@dataset().folderPath",
              "type": "Expression"
            },
            "fileName": {
              "value": "@dataset().fileName",
              "type": "Expression"
            },
            "fileSystem": "gold"
          },
          "compressionCodec": "snappy"
        },
        "schema": []
      }
    },
    {
      "type": "Microsoft.DataFactory/factories/datasets",
      "apiVersion": "2018-06-01",
      "name": "[concat(parameters('factoryName'), '/ScriptsContainer')]",
      "properties": {
        "linkedServiceName": {
          "referenceName": "AzureDataLakeStorageGen2",
          "type": "LinkedServiceReference"
        },
        "parameters": {
          "folderPath": {
            "type": "String"
          },
          "fileName": {
            "type": "String"
          }
        },
        "annotations": [],
        "type": "Binary",
        "typeProperties": {
          "location": {
            "type": "AzureBlobFSLocation",
            "folderPath": {
              "value": "@dataset().folderPath",
              "type": "Expression"
            },
            "fileName": {
              "value": "@dataset().fileName",
              "type": "Expression"
            },
            "fileSystem": "scripts"
          }
        }
      }
    }
  ]
}



